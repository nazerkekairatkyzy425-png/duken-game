<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8">
  <title>–î“Ø–∫–µ–Ω –æ–π—ã–Ω—ã</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      text-align: center;
      padding: 30px;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      max-width: 450px;
      margin: auto;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    input, button {
      padding: 10px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 80%;
    }
    button {
      background: #4caf50;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background: #45a049;
    }
    #result {
      margin-top: 15px;
      font-weight: bold;
    }
    #score, #timer, #level {
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>üõí –î“Ø–∫–µ–Ω –æ–π—ã–Ω—ã</h2>
    <p id="item"></p>
    <p id="price"></p>
    <p id="discount"></p>
    <p id="vat"></p>

    <p>–°–æ“£“ì—ã —Ç”©–ª–µ–º–¥—ñ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:</p>
    <input type="number" id="answer" placeholder="–°–æ–º–∞–Ω—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑">
    <br>
    <button onclick="checkAnswer()">–¢–µ–∫—Å–µ—Ä—É</button>
    <button onclick="newGame()">–ñ–∞“£–∞ –æ–π—ã–Ω</button>

    <p id="result"></p>
    <p id="score">“∞–ø–∞–π: 0</p>
    <p id="level">–î–µ“£–≥–µ–π: 1</p>
    <p id="timer">–£–∞“õ—ã—Ç: 60 —Å</p>
  </div>

  <script>
    let current;
    let score = 0;
    let level = 1;
    let timeLeft = 60;
    let timer;

    const items = [
      {name: "–¢–µ–ª–µ—Ñ–æ–Ω", price: 100000, discount: 10},
      {name: "–ù–æ—É—Ç–±—É–∫", price: 250000, discount: 15},
      {name: "“ö“±–ª–∞“õ“õ–∞–ø", price: 20000, discount: 5},
      {name: "–°”©–º–∫–µ", price: 15000, discount: 20},
      {name: "–°–ø–æ—Ä—Ç –∞—è“õ-–∫–∏—ñ–º", price: 50000, discount: 12},
      {name: "–°–∞“ì–∞—Ç", price: 30000, discount: 8},
      {name: "–¢–µ–ª–µ–¥–∏–¥–∞—Ä", price: 180000, discount: 18}
    ];

    function newGame() {
      current = [];
      // –¥–µ“£–≥–µ–π–≥–µ “õ–∞—Ä–∞–π –µ—Å–µ–ø –∫“Ø—Ä–¥–µ–ª–µ–Ω–µ —Ç“Ø—Å–µ–¥—ñ
      let itemCount = level < 3 ? 1 : (level < 5 ? 2 : 3); // –¥–µ“£–≥–µ–π –∂–æ“ì–∞—Ä—ã–ª–∞“ì–∞–Ω —Å–∞–π—ã–Ω –±—ñ—Ä–Ω–µ—à–µ —Ç–∞—É–∞—Ä “õ–æ—Å—ã–ª–∞–¥—ã
      for (let i = 0; i < itemCount; i++) {
        current.push(items[Math.floor(Math.random() * items.length)]);
      }

      let itemText = current.map((it, idx) => (idx+1) + ". " + it.name + " ‚Äî " + it.price.toLocaleString() + " ‚Ç∏ (–∂–µ“£—ñ–ª–¥—ñ–∫: " + it.discount + "%)").join("<br>");
      document.getElementById("item").innerHTML = "<b>–¢–∞—É–∞—Ä–ª–∞—Ä:</b><br>" + itemText;
      document.getElementById("price").innerHTML = "";
      document.getElementById("discount").innerHTML = "";
      document.getElementById("vat").innerHTML = "<b>“ö“ö–°:</b> " + (level >= 4 ? "15%" : "12%") + " (–¥–µ“£–≥–µ–π–≥–µ –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã)";
      document.getElementById("answer").value = "";
      document.getElementById("result").innerHTML = "";
      resetTimer();
    }

    function checkAnswer() {
      let total = 0;
      let vatRate = (level >= 4 ? 0.15 : 0.12);

      current.forEach(it => {
        let discount = it.price * (it.discount / 100);
        let afterDiscount = it.price - discount;
        let vat = afterDiscount * vatRate;
        total += afterDiscount + vat;
      });

      let userAnswer = document.getElementById("answer").value;
      let result = document.getElementById("result");

      if (Math.abs(userAnswer - total) < 1) {
        result.innerHTML = "‚úÖ –ñ–∞—Ä–∞–π—Å—ã“£! –î“±—Ä—ã—Å –∂–∞—É–∞–ø: " + total.toFixed(2) + " ‚Ç∏";
        result.style.color = "green";
        score++;
      } else {
        result.innerHTML = "‚ùå “ö–∞—Ç–µ. –î“±—Ä—ã—Å –∂–∞—É–∞–ø: " + total.toFixed(2) + " ‚Ç∏";
        result.style.color = "red";
      }
      document.getElementById("score").innerHTML = "“∞–ø–∞–π: " + score;

      checkLevel();
    }

    function checkLevel() {
      if (score > 0 && score % 5 === 0) {
        level++;
        document.getElementById("level").innerHTML = "–î–µ“£–≥–µ–π: " + level;
        alert("üéâ “ö“±—Ç—Ç—ã“õ—Ç–∞–π–º—ã–∑! –°—ñ–∑ " + level + "-–¥–µ“£–≥–µ–π–≥–µ ”©—Ç—Ç—ñ“£—ñ–∑! –ï–Ω–¥—ñ –µ—Å–µ–ø “õ–∏—ã–Ω–¥–∞–π–¥—ã.");
      }
    }

    function startTimer() {
      timer = setInterval(() => {
        if (timeLeft > 0) {
          timeLeft--;
          document.getElementById("timer").innerHTML = "–£–∞“õ—ã—Ç: " + timeLeft + " —Å";
        } else {
          clearInterval(timer);
          document.getElementById("result").innerHTML = "‚è∞ –£–∞“õ—ã—Ç –±—ñ—Ç—ñ!";
          document.getElementById("result").style.color = "orange";
        }
      }, 1000);
    }

    function resetTimer() {
      clearInterval(timer);
      timeLeft = 60;
      document.getElementById("timer").innerHTML = "–£–∞“õ—ã—Ç: 60 —Å";
      startTimer();
    }

    // –û–π—ã–Ω –±–∞—Å—Ç–∞–ª“ì–∞–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç—Ç—ã —Ç“Ø—Ä–¥–µ –∂“Ø–∫—Ç–µ—É
    window.onload = newGame;
  </script>
</body>
</html>
